{"ast":null,"code":"const initialState = {\n  items: {},\n  totalPrice: 0,\n  totalCount: 0\n};\n\nconst getTotalPrice = arr => arr.reduce((sum, obj) => obj.price + sum, 0);\n\nconst cart = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n\n  if (action.type === 'PLUS_CART_ITEM') {\n    const newItems1 = [...state.items[action.payload].items, state.items[action.payload].items[0]];\n    return { ...state.items,\n      items: { ...state.items,\n        [action.payload]: {\n          items: newItems1,\n          totalPrice: getTotalPrice(newItems1)\n        }\n      }\n    };\n  }\n\n  if (action.type === 'MINUS_CART_ITEM') {\n    const oldItems = state.items[action.payload].items;\n    const newItems = oldItems.length > 1 ? oldItems.slice(1) : oldItems;\n    return { ...state,\n      items: {\n        [action.payload]: {\n          items: newItems,\n          totalPrice: getTotalPrice(newItems)\n        }\n      }\n    };\n  }\n\n  if (action.type === 'REMOVE_1PIZZA') {\n    const newItems = { ...state.items\n    };\n    const currentTotalPrice = newItems[action.payload].totalPrice;\n    const currentTotalCount = newItems[action.payload].items.length;\n    console.log('---', currentTotalCount);\n    delete newItems[action.payload];\n    return { ...state,\n      items: newItems,\n      totalPrice: state.totalPrice - currentTotalPrice,\n      totalCount: state.totalCount - currentTotalCount\n    };\n  }\n\n  if (action.type === 'ADD_PIZZA_CART') {\n    const currenPizzaItems = !state.items[action.payload.id] ? [action.payload] : [...state.items[action.payload.id].items, action.payload];\n    const newItems = { ...state.items,\n      [action.payload.id]: {\n        items: currenPizzaItems,\n        totalPrice: getTotalPrice(currenPizzaItems)\n      }\n    };\n    const items = Object.values(newItems).map(obj => obj.items);\n    const allPizzas = [].concat.apply([], items);\n    const totalPrice = getTotalPrice(allPizzas);\n    return { ...state,\n      items: newItems,\n      totalCount: allPizzas.length,\n      totalPrice: totalPrice\n    };\n  } else if (action.type === 'CLEAR_CART') {\n    return {\n      totalCount: 0,\n      totalPrice: 0,\n      items: {}\n    };\n  }\n\n  return state;\n};\n\nexport default cart;","map":{"version":3,"sources":["C:/programs/react/React-pizza/my-app/src/redux/reducers/cart.js"],"names":["initialState","items","totalPrice","totalCount","getTotalPrice","arr","reduce","sum","obj","price","cart","state","action","type","newItems1","payload","oldItems","newItems","length","slice","currentTotalPrice","currentTotalCount","console","log","currenPizzaItems","id","Object","values","map","allPizzas","concat","apply"],"mappings":"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","sourcesContent":["const initialState = {\r\n    items: {},\r\n    totalPrice: 0,\r\n    totalCount: 0\r\n}\r\n\r\nconst getTotalPrice = arr => arr.reduce((sum, obj) => obj.price + sum, 0   )\r\n\r\n\r\n const cart = (state = initialState, action) => {\r\n\r\n    if (action.type === 'PLUS_CART_ITEM') {\r\n\r\n        const newItems1 = [\r\n            ...state.items[action.payload].items,\r\n            state.items[action.payload].items[0],\r\n        ]\r\n        return {\r\n            ...state.items,\r\n            items: {\r\n                ...state.items,\r\n                [action.payload]: {\r\n                    items: newItems1,\r\n                    totalPrice: getTotalPrice(newItems1)\r\n                }\r\n                \r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    if (action.type === 'MINUS_CART_ITEM') {\r\n        const oldItems = state.items[action.payload].items\r\n        const newItems =  oldItems.length > 1 \r\n        ? oldItems.slice(1)\r\n        : oldItems\r\n       \r\n        return {\r\n            ...state,\r\n            items: {\r\n                [action.payload]: {\r\n                    items: newItems,\r\n                    totalPrice: getTotalPrice(newItems)\r\n                }\r\n                \r\n            }\r\n        }\r\n    }\r\n    \r\n\r\n    if (action.type === 'REMOVE_1PIZZA') {\r\n\r\n\r\n        const newItems = {\r\n            ...state.items,\r\n           }\r\n\r\n        const currentTotalPrice = newItems[action.payload].totalPrice\r\n        const currentTotalCount = newItems[action.payload].items.length\r\n        console.log('---',  currentTotalCount)\r\n        delete newItems[action.payload]\r\n\r\n        return{\r\n            ...state,\r\n            items: newItems,\r\n            totalPrice: state.totalPrice - currentTotalPrice,\r\n            totalCount: state.totalCount - currentTotalCount,\r\n         }\r\n\r\n\r\n\r\n    }\r\n\r\n    if (action.type === 'ADD_PIZZA_CART') {\r\n        const currenPizzaItems = !state.items[action.payload.id] \r\n        ? [action.payload] \r\n        : [...state.items[action.payload.id].items, action.payload]\r\n\r\n        const newItems = {\r\n            ...state.items,\r\n            [action.payload.id]: {\r\n                items: currenPizzaItems,\r\n                totalPrice: getTotalPrice(currenPizzaItems)\r\n            }\r\n        }\r\n\r\n        const items = Object.values(newItems).map(obj => obj.items)\r\n        const allPizzas = [].concat.apply([], items)\r\n        const totalPrice = getTotalPrice(allPizzas)\r\n\r\n        return {\r\n            ...state,\r\n            items: newItems,\r\n            totalCount: allPizzas.length, \r\n            totalPrice: totalPrice\r\n        }\r\n    }\r\n    else if (action.type ==='CLEAR_CART'){\r\n        return {\r\n            totalCount: 0,\r\n            totalPrice: 0,\r\n            items: {}}\r\n    }\r\n    return state\r\n}\r\n\r\n\r\n\r\nexport default cart"]},"metadata":{},"sourceType":"module"}