{"ast":null,"code":"const initialState = {\n  items: {},\n  totalPrice: 0,\n  totalCount: 0\n};\n\nconst getTotalPrice = arr => arr.reduce((sum, obj) => obj.price + sum, 0);\n\nconst cart = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n\n  if (action.type === 'PLUS_CART_ITEM') {\n    const newItems1 = [...state.items[action.payload].items, state.items[action.payload].items[0]];\n    let count = state.items[action.payload].items.length;\n    let cost1pizza = state.items[action.payload].totalPrice / count; // console.log('count', cost1pizza, ' ', state.items[action.payload].totalPrice)\n    // const currentTotalCount = newItems1[action.payload].items.length\n    // console.log(currentTotalPrice, currentTotalCount)\n\n    return { ...state,\n      items: { ...state.items,\n        [action.payload]: {\n          items: newItems1,\n          totalPrice: getTotalPrice(newItems1)\n        }\n      },\n      totalCount: state.totalCount + 1,\n      totalPrice: state.totalPrice + cost1pizza\n    };\n  }\n\n  if (action.type === 'MINUS_CART_ITEM') {\n    let count = state.items[action.payload].items.length;\n    let cost1pizza = state.items[action.payload].totalPrice / count;\n    const oldItems = state.items[action.payload].items;\n    const newItems = oldItems.length > 1 ? oldItems.slice(1) : oldItems;\n    return { ...state,\n      items: { ...state.items,\n        [action.payload]: {\n          items: newItems,\n          totalPrice: getTotalPrice(newItems)\n        }\n      },\n      totalCount: count > 1 ? state.totalCount - 1 : state.totalCount,\n      totalPrice: count > 1 ? state.totalPrice - cost1pizza : state.totalPrice\n    };\n  }\n\n  if (action.type === 'REMOVE_1PIZZA') {\n    const newItems = { ...state.items\n    };\n    const currentTotalPrice = newItems[action.payload].totalPrice;\n    const currentTotalCount = newItems[action.payload].items.length;\n    console.log('---', currentTotalCount);\n    delete newItems[action.payload];\n    return { ...state,\n      items: newItems,\n      totalPrice: state.totalPrice - currentTotalPrice,\n      totalCount: state.totalCount - currentTotalCount\n    };\n  }\n\n  if (action.type === 'ADD_PIZZA_CART') {\n    const currenPizzaItems = !state.items[action.payload.id] ? [action.payload] : [...state.items[action.payload.id].items, action.payload];\n    const newItems = { ...state.items,\n      [action.payload.id]: {\n        items: currenPizzaItems,\n        totalPrice: getTotalPrice(currenPizzaItems)\n      }\n    };\n    const items = Object.values(newItems).map(obj => obj.items);\n    const allPizzas = [].concat.apply([], items);\n    const totalPrice = getTotalPrice(allPizzas);\n    return { ...state,\n      items: newItems,\n      totalCount: allPizzas.length,\n      totalPrice: totalPrice\n    };\n  } else if (action.type === 'CLEAR_CART') {\n    return {\n      totalCount: 0,\n      totalPrice: 0,\n      items: {}\n    };\n  }\n\n  return state;\n};\n\nexport default cart;","map":{"version":3,"sources":["C:/programs/react/React-pizza/my-app/src/redux/reducers/cart.js"],"names":["initialState","items","totalPrice","totalCount","getTotalPrice","arr","reduce","sum","obj","price","cart","state","action","type","newItems1","payload","count","length","cost1pizza","oldItems","newItems","slice","currentTotalPrice","currentTotalCount","console","log","currenPizzaItems","id","Object","values","map","allPizzas","concat","apply"],"mappings":"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","sourcesContent":["const initialState = {\r\n    items: {},\r\n    totalPrice: 0,\r\n    totalCount: 0\r\n}\r\n\r\nconst getTotalPrice = arr => arr.reduce((sum, obj) => obj.price + sum, 0   )\r\n\r\n\r\n const cart = (state = initialState, action) => {\r\n\r\n    if (action.type === 'PLUS_CART_ITEM') {\r\n\r\n        const newItems1 = [\r\n            ...state.items[action.payload].items,\r\n            state.items[action.payload].items[0],\r\n        ]\r\n        let count = state.items[action.payload].items.length \r\n        let cost1pizza = state.items[action.payload].totalPrice / count\r\n        // console.log('count', cost1pizza, ' ', state.items[action.payload].totalPrice)\r\n        // const currentTotalCount = newItems1[action.payload].items.length\r\n        // console.log(currentTotalPrice, currentTotalCount)\r\n        return {\r\n            ...state,\r\n            items: {\r\n                ...state.items,\r\n                [action.payload]: {\r\n                    items: newItems1,\r\n                    totalPrice: getTotalPrice(newItems1)\r\n                }\r\n            },\r\n            totalCount: state.totalCount + 1,\r\n            totalPrice: state.totalPrice + cost1pizza,\r\n        }\r\n    }\r\n\r\n\r\n    if (action.type === 'MINUS_CART_ITEM') {\r\n        let count = state.items[action.payload].items.length \r\n        let cost1pizza = state.items[action.payload].totalPrice / count\r\n\r\n\r\n        const oldItems = state.items[action.payload].items\r\n        const newItems =  oldItems.length > 1 \r\n        ? oldItems.slice(1)\r\n        : oldItems\r\n       \r\n        return {\r\n            ...state,\r\n            items: {\r\n                ...state.items,\r\n                [action.payload]: {\r\n                    items: newItems,\r\n                    totalPrice: getTotalPrice(newItems)\r\n                }\r\n            },\r\n            totalCount: count > 1 ? state.totalCount - 1 : state.totalCount,\r\n            totalPrice: count > 1 ? state.totalPrice - cost1pizza : state.totalPrice,\r\n        }\r\n    }\r\n    \r\n\r\n    if (action.type === 'REMOVE_1PIZZA') {\r\n\r\n\r\n        const newItems = {\r\n            ...state.items,\r\n           }\r\n\r\n        const currentTotalPrice = newItems[action.payload].totalPrice\r\n        const currentTotalCount = newItems[action.payload].items.length\r\n        console.log('---',  currentTotalCount)\r\n        delete newItems[action.payload]\r\n\r\n        return{\r\n            ...state,\r\n            items: newItems,\r\n            totalPrice: state.totalPrice - currentTotalPrice,\r\n            totalCount: state.totalCount - currentTotalCount,\r\n         }\r\n\r\n\r\n\r\n    }\r\n\r\n    if (action.type === 'ADD_PIZZA_CART') {\r\n        const currenPizzaItems = !state.items[action.payload.id] \r\n        ? [action.payload] \r\n        : [...state.items[action.payload.id].items, action.payload]\r\n\r\n        const newItems = {\r\n            ...state.items,\r\n            [action.payload.id]: {\r\n                items: currenPizzaItems,\r\n                totalPrice: getTotalPrice(currenPizzaItems)\r\n            }\r\n        }\r\n\r\n        const items = Object.values(newItems).map(obj => obj.items)\r\n        const allPizzas = [].concat.apply([], items)\r\n        const totalPrice = getTotalPrice(allPizzas)\r\n\r\n        return {\r\n            ...state,\r\n            items: newItems,\r\n            totalCount: allPizzas.length, \r\n            totalPrice: totalPrice\r\n        }\r\n    }\r\n    else if (action.type ==='CLEAR_CART'){\r\n        return {\r\n            totalCount: 0,\r\n            totalPrice: 0,\r\n            items: {}}\r\n    }\r\n    return state\r\n}\r\n\r\n\r\n\r\nexport default cart"]},"metadata":{},"sourceType":"module"}